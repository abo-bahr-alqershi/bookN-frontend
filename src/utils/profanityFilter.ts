/**
 * أداة للتحقق من الكلمات البذيئة في النص
 * Profanity filter with fuzzy matching in Arabic
 */


// قائمة الكلمات البذيئة (استبدل العناصر التالية بالقائمة الكاملة من 750+ كلمة)
const badWords: string[] = [
    'يا',
    'كلب',
    'حيوان',
    'حقير',
    'حثالة',
    'زبالة',
    'قذر',
    'وغد',
    'سافل',
    'منحط',
    'تافه',
    'غبي',
    'أحمق',
    'مغفل',
    'معتوه',
    'أبله',
    'متخلف',
    'جاهل',
    'زنديق',
    'كافر',
    'ملحد',
    'فاسق',
    'عاهر',
    'داعرة',
    'شرموطة',
    'قحبة',
    'ابن حرام',
    'ابن كلب',
    'لعين',
    'ملعون',
    'سخيف',
    'وقح',
    'جحش',
    'حمار',
    'ثور',
    'خنزير',
    'قرد',
    'نذل',
    'خسيس',
    'واطي',
    'عرة',
    'زفت',
    'خرا',
    'تبا',
    'اللعنة',
    'جنس',
    'نيك',
    'طيز',
    'كس',
    'زب',
    'بزاز',
    'مؤخرة',
    'لعق',
    'مص',
    'شهوة',
    'مني',
    'بول',
    'براز',
    'شاذ',
    'لوطي',
    'مثلي',
    'سحاقية',
    'ديوث',
    'خول',
    'عرص',
    'متناك',
    'منيوك',
    'ميبون',
    'مخنث',
    'فاجر',
    'زاني',
    'زانية',
    'قاتل',
    'مجرم',
    'إرهابي',
    'داعشي',
    'نصاب',
    'حرامي',
    'سارق',
    'محتال',
    'كذاب',
    'دجال',
    'منافق',
    'خائن',
    'عميل',
    'جاسوس',
    'عنصري',
    'متعصب',
    'كريه',
    'مقرف',
    'نتن',
    'معفن',
    'عفن',
    'جيفة',
    'رمة',
    'مريض',
    'نفسية',
    'مختل',
    'مجنون',
    'مهووس',
    'سفيه',
    'تافه',
    'حثالة المجتمع',
    'عديم الأخلاق',
    'عديم الشرف',
    'عديم الكرامة',
    'بذيء',
    'فاحش',
    'منحل',
    'فاسد',
    'مفسد',
    'شرير',
    'لص',
    'وغد',
    'حثالة',
    'قمامة',
    'قواد',
    'دعارة',
    'بغاء',
    'زنا',
    'لواط',
    'سحاق',
    'اغتصاب',
    'تحرش',
    'شتم',
    'سب',
    'لعن',
    'بصق',
    'حمارة',
    'كلبة',
    'خنزيرة',
    'بقرة',
    'تيس',
    'صايع',
    'ضايع',
    'داشر',
    'هامل',
    'سكير',
    'عربيد',
    'سكران',
    'محشش',
    'مدمن',
    'شمام',
    'صعلوك',
    'متشرد',
    'شحات',
    'طرار',
    'متسول',
    'جزمه',
    'صرماية',
    'كندرة',
    'نعال',
    'شبشب',
    'ابن الكلب',
    'ابن الشرموطة',
    'ابن القحبة',
    'يلعن ابوك',
    'يلعن امك',
    'يلعن دينك',
    'يلعن ربك',
    'يلعن عرضك',
    'يلعن شرفك',
    'كس امك',
    'طيز امك',
    'اخو الشرموطة',
    'اخو القحبة',
    'اخت العاهرة',
    'عرص',
    'ديوث',
    'خول',
    'متناك',
    'منيوك',
    'لوطي',
    'شاذ',
    'وسخ',
    'قذر',
    'زبالة',
    'حقير',
    'نذل',
    'واطي',
    'خسيس',
    'تافه',
    'سخيف',
    'غبي',
    'احمق',
    'حمار',
    'كلب',
    'حيوان',
    'خنزير',
    'معفن',
    'نتن',
    'كريه',
    'بغيض',
    'علة',
    'مصيبة',
    'بلوة',
    'داشر',
    'صايع',
    'فاشل',
    'عاطل',
    'باطل',
    'حرامي',
    'نصاب',
    'كذاب',
    'دجال',
    'منافق',
    'خائن',
    'عميل',
    'جاسوس',
    'عنصري',
    'متخلف',
    'جاهل',
    'بدائي',
    'همجي',
    'بربري',
    'متوحش',
    'ارهابي',
    'مجرم',
    'قاتل',
    'سفاح',
    'جلاد',
    'طاغية',
    'ظالم',
    'مستبد',
    'دكتاتور',
    'فاسد',
    'مفسد',
    'شرير',
    'شيطان',
    'ابليس',
    'لعين',
    'ملعون',
    'منبوذ',
    'مكروه',
    'بغيض',
    'مقيت',
    'تافه',
    'رخيص',
    'ساقط',
    'لقيط',
    'ابن الزنا',
    'ابن الحرام',
    'عديم الاصل',
    'قليل الادب',
    'قليل الحياء',
    'قليل التربية',
    'عديم التربية',
    'عديم الضمير',
    'عديم الانسانية',
    'عديم المروءة',
    'عديم النخوة',
    'جبان',
    'خواف',
    'رعديد',
    'خنوع',
    'ذليل',
    'مهان',
    'منكسر',
    'ضعيف',
    'مسكين',
    'فقير',
    'معدم',
    'بائس',
    'تعيس',
    'شقي',
    'منحوس',
    'فقر',
    'نكد',
    'هم',
    'غم',
    'حزن',
    'كآبة',
    'احباط',
    'يأس',
    'قنوط',
    'فشل',
    'خيبة',
    'حسرة',
    'ندم',
    'ألم',
    'وجع',
    'عذاب',
    'جحيم',
    'نار',
    'سقر',
    'ويل',
    'ثبور',
    'هلاك',
    'دمار',
    'خراب',
    'موت',
    'قتل',
    'ذبح',
    'سلخ',
    'حرق',
    'غرق',
    'نسف',
    'تفجير',
    'تدمير',
    'ابادة',
    'مجزرة',
    'مذبحة',
    'محرقة',
    'هولوكوست',
    'جريمة',
    'جناية',
    'معصية',
    'ذنب',
    'خطيئة',
    'اثم',
    'وزر',
    'سيئة',
    'فاحشة',
    'منكر',
    'بغي',
    'عدوان',
    'ظلم',
    'جور',
    'طغيان',
    'استبداد',
    'قهر',
    'قمع',
    'اضطهاد',
    'تعذيب',
    'تنكيل',
    'اهانة',
    'اذلال',
    'احتقار',
    'ازدراء',
    'سخرية',
    'استهزاء',
    'تهكم',
    'شماتة',
    'غيبة',
    'نميمة',
    'بهتان',
    'افتراء',
    'كذب',
    'زور',
    'بهتان',
    'خداع',
    'غش',
    'تدليس',
    'تزوير',
    'تحريف',
    'سرقة',
    'نهب',
    'سلب',
    'اختلاس',
    'رشوة',
    'فساد',
    'محسوبية',
    'واسطة',
    'استغلال',
    'احتكار',
    'ربا',
    'قمار',
    'ميسر',
    'سكر',
    'خمر',
    'مخدرات',
    'حشيش',
    'افيون',
    'كوكايين',
    'هيروين',
    'ادمان',
    'دعارة',
    'بغاء',
    'زنا',
    'لواط',
    'سحاق',
    'شذوذ',
    'انحراف',
    'فسوق',
    'عصيان',
    'تمرد',
    'خروج',
    'فتنة',
    'فوضى',
    'شغب',
    'عنف',
    'ارهاب',
    'تطرف',
    'غلو',
    'تعصب',
    'كراهية',
    'حقد',
    'ضغينة',
    'حسد',
    'غيرة',
    'بغضاء',
    'عداوة',
    'كره',
    'بغض',
    'مقت',
    'ازدراء',
    'احتقار',
    'استعلاء',
    'تكبر',
    'غرور',
    'عجرفة',
    'صلف',
    'غطرسة',
    'خيلاء',
    'بطر',
    'أشر',
    'مرح',
    'لهو',
    'لعب',
    'عبث',
    'باطل',
    'هراء',
    'سفه',
    'جهل',
    'حمق',
    'غباء',
    'بلاهة',
    'تخلف',
    'بلادة',
    'غفلة',
    'سهو',
    'نسيان',
    'شرود',
    'توهان',
    'ضياع',
    'حيرة',
    'تردد',
    'شك',
    'ريبة',
    'ظن',
    'وهم',
    'خيال',
    'سراب',
    'حلم',
    'كابوس',
    'وسواس',
    'قلق',
    'خوف',
    'رعب',
    'فزع',
    'هلع',
    'جزع',
    'رهبة',
    'خشية',
    'تقية',
    'نفاق',
    'رياء',
    'سمعة',
    'تظاهر',
    'تصنع',
    'تكلف',
    'ادعاء',
    'كبر',
    'عجب',
    'من',
    'أذى',
    'ضرر',
    'سوء',
    'شر',
    'بلاء',
    'مصيبة',
    'كارثة',
    'نكبة',
    'فاجعة',
    'رزية',
    'محنة',
    'شدة',
    'ضيق',
    'كرب',
    'عسر',
    'مشقة',
    'عناء',
    'تعب',
    'نصب',
    'وصب',
    'سقم',
    'مرض',
    'علة',
    'داء',
    'وباء',
    'طاعون',
    'جائحة',
    'آفة',
    'عاهة',
    'نقص',
    'عيب',
    'وصمة',
    'عار',
    'خزي',
    'فضيحة',
    'هتك',
    'كشف',
    'تعرية',
    'تجريس',
    'تشهير',
    'قذف',
    'ثلب',
    'لمز',
    'همز',
    'طعن',
    'تجريح',
    'انتقاد',
    'لوم',
    'عتب',
    'توبيخ',
    'تقريع',
    'زجر',
    'نهر',
    'صد',
    'رفض',
    'نبذ',
    'هجر',
    'قطيعة',
    'خصام',
    'نزاع',
    'شقاق',
    'خلاف',
    'صراع',
    'قتال',
    'حرب',
    'معركة',
    'موقعة',
    'غزوة',
    'عدوان',
    'احتلال',
    'استعمار',
    'استعباد',
    'رق',
    'عبودية',
    'سخرة',
    'استغلال',
    'اضطهاد',
    'تمييز',
    'عنصرية',
    'طبقية',
    'طائفية',
    'قبلية',
    'عشائرية',
    'عصبية',
    'جاهلية',
    'همجية',
    'وحشية',
    'بربرية',
    'تخلف',
    'رجعية',
    'انحطاط',
    'تدهور',
    'انهيار',
    'سقوط',
    'فناء',
    'زوال',
    'اندثار',
    'انقراض',
    'عدم',
    'فراغ',
    'خواء',
    'صفر',
    'لا شيء',
    'هباء',
    'رماد',
    'تراب',
    'طين',
    'وحل',
    'مستنقع',
    'بالوعة',
    'مجاري',
    'مزبلة',
    'مكب',
    'قمامة',
    'زبالة',
    'قذارة',
    'وسخ',
    'دنس',
    'رجس',
    'نجس',
    'عفن',
    'نتانة',
    'خياس',
    'صنان',
    'زنخة',
    'قرف',
    'اشمئزاز',
    'غثيان',
    'تقيؤ',
    'استفراغ',
    'بصاق',
    'مخاط',
    'صديد',
    'قيح',
    'دم',
    'جيفة',
    'رمم',
    'جثة',
    'ميت',
    'هالك',
    'فان',
    'زائل',
    'منته',
    'تافه',
    'حقير',
    'وضيع',
    'دنيء',
    'خسيس',
    'نذل',
    'وغد',
    'سافل',
    'منحط',
    'ساقط',
    'لقيط',
    'هجين',
    'منبوذ',
    'مطرود',
    'مبعد',
    'منفي',
    'غريب',
    'أجنبي',
    'دخيل',
    'طفيلي',
    'علقة',
    'جرثومة',
    'فيروس',
    'سرطان',
    'وباء',
    'طاعون',
    'آفة',
    'نكبة',
    'مصيبة',
    'كارثة',
    'داهية',
    'بلية',
    'رزية',
    'نائبة',
    'خطب',
    'فادح',
    'جسيم',
    'عظيم',
    'مهول',
    'فظيع',
    'شنيع',
    'بشع',
    'قبيح',
    'دمدميم',
    'مشوه',
    'ناقص',
    'معيب',
    'مختل',
    'معتوه',
    'مجنون',
    'اهبل',
    'طرطور',
    'خيال مآتة',
    'اراجوز',
    'بهلوان',
    'مهرج',
    'مسخرة',
    'اضحوكة',
    'مهزلة',
    'عار',
    'وصمة',
    'شنار',
    'خزي',
    'ذل',
    'هوان',
    'صغار',
    'انكسار',
    'هزيمة',
    'فشل',
    'اخفاق',
    'خيبة',
    'حسرة',
    'ندم',
    'اسف',
    'حزن',
    'كمد',
    'لوعة',
    'حرقة',
    'غصة',
    'الم',
    'وجع',
    'معاناة',
    'شقاء',
    'بؤس',
    'تعاسة',
    'حرمان',
    'فقر',
    'عوز',
    'حاجة',
    'فاقة',
    'املاق',
    'عيلة',
    'مسكنة',
    'ذلة',
    'ضعة',
    'هوان',
    'خنوع',
    'استكانة',
    'خضوع',
    'انقياد',
    'تبعية',
    'عمالة',
    'خيانة',
    'غدر',
    'نكث',
    'حنث',
    'كفر',
    'جحود',
    'نكران',
    'عقوق',
    'تمرد',
    'عصيان',
    'فسوق',
    'فجور',
    'طغيان',
    'بغي',
    'عدوان',
    'ظلم',
    'جور',
    'حيف',
    'غبن',
    'هضم',
    'بخس',
    'تطفيف',
    'غش',
    'خداع',
    'مكر',
    'كيد',
    'حيلة',
    'دهاء',
    'خبث',
    'لؤم',
    'دناءة',
    'خسة',
    'نذالة',
    'حقارة',
    'سفالة',
    'انحطاط',
    'بذاءة',
    'فحش',
    'خلاعة',
    'مجون',
    'تهتك',
    'اباحية',
    'عري',
    'فضيحة',
    'تشهير',
    'قذف',
    'سب',
    'شتم',
    'لعن',
    'تجديف',
    'كفر',
    'الحاد',
    'زندقة',
    'هرطقة',
    'بدعة',
    'ضلالة',
    'غواية',
    'فتنة',
    'شرك',
    'وثنية',
    'عبادة الاصنام',
    'سحر',
    'شعوذة',
    'دجل',
    'كهانة',
    'عرافة',
    'تنجيم',
    'تطير',
    'تشاؤم',
    'نحس',
    'سوء طالع',
    'بؤس',
    'شقاء',
    'هلاك',
    'دمار',
    'فناء',
    'موت',
    'جحيم',
    'سقر',
    'لظى',
    'سعير',
    'درك اسفل',
  ];
  

/**
 * الحد الأدنى لنسبة التشابه لاعتبار الكلمة بذيئة
 */
export const PROFANITY_THRESHOLD = 0.9;

/**
 * حساب مسافة جارو (Jaro) بين سلسلتين نصيتين
 */
function jaroDistance(a: string, b: string): number {
  if (a === b) return 1;
  const lenA = a.length, lenB = b.length;
  const matchDist = Math.floor(Math.max(lenA, lenB) / 2) - 1;
  const aMatches = Array<boolean>(lenA).fill(false);
  const bMatches = Array<boolean>(lenB).fill(false);
  let matches = 0;
  for (let i = 0; i < lenA; i++) {
    const start = Math.max(0, i - matchDist);
    const end = Math.min(i + matchDist + 1, lenB);
    for (let j = start; j < end; j++) {
      if (!bMatches[j] && a[i] === b[j]) {
        aMatches[i] = bMatches[j] = true;
        matches++;
        break;
      }
    }
  }
  if (matches === 0) return 0;
  let transpositions = 0;
  let k = 0;
  for (let i = 0; i < lenA; i++) {
    if (aMatches[i]) {
      while (!bMatches[k]) k++;
      if (a[i] !== b[k]) transpositions++;
      k++;
    }
  }
  transpositions = transpositions / 2;
  return (
    (matches / lenA + matches / lenB + (matches - transpositions) / matches) / 3
  );
}

/**
 * حساب مسافة جارو-وينكلر (Jaro-Winkler) بين سلسلتين نصيتين
 */
function jaroWinkler(a: string, b: string, prefixScale: number = 0.1): number {
  const jaroDist = jaroDistance(a, b);
  let prefix = 0;
  const maxPrefix = Math.min(4, Math.min(a.length, b.length));
  for (let i = 0; i < maxPrefix; i++) {
    if (a[i] === b[i]) prefix++;
    else break;
  }
  return jaroDist + prefix * prefixScale * (1 - jaroDist);
}

/**
 * إرجاع أعلى نسبة تشابه بين الكلمة الممرّرة وكلمات القائمة
 */
export function getProfanityScore(word: string): number {
  const w = word.trim().toLowerCase();
  if (!w) return 0;
  let maxScore = 0;
  for (const b of badWords) {
    const score = jaroWinkler(w, b.toLowerCase());
    if (score > maxScore) maxScore = score;
  }
  return maxScore;
}

/**
 * فحص كلمة إذا كانت بذيئة باقتراب احترافي
 */
export function isProfane(word: string): boolean {
  return getProfanityScore(word) >= PROFANITY_THRESHOLD;
} 